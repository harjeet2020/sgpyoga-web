{# ========================================================================
   FEATURED POSTS SLIDESHOW COMPONENT (ENGLISH)
   ========================================================================
   
   Displays featured blog posts in English only
   ======================================================================== #}

{# Filter featured posts for English language manually #}
{% set featuredSlides = [] %}
{% for post in collections.featuredPosts %}
  {% if post.data.lang == "en" %}
    {% set featuredSlides = (featuredSlides.push(post), featuredSlides) %}
  {% endif %}
{% endfor %}

{# Only render if we have English featured posts #}
{% if featuredSlides | length > 0 %}
<section class="featured-posts-section">
    <div class="container">
        <!-- Section Header -->
        <div class="featured-posts-header">
            <h1 data-i18n="blog:featured.title">Featured Posts</h1>
            <p data-i18n="blog:featured.subtitle">Discover our most popular insights and practices</p>
        </div>

        <!-- Slideshow Container -->
        <div class="featured-posts-slideshow" id="featuredPostsSlideshow">
            <div class="featured-posts-wrapper">
                {% for post in featuredSlides %}
                {# Determine if this is the first slide (for eager loading) #}
                {% set isFirstSlide = loop.index0 == 0 %}
                {% set loadingStrategy = "lazy" %}
                {% if isFirstSlide %}
                    {% set loadingStrategy = "eager" %}
                {% endif %}
                
                <!-- Featured Slide {{ loop.index }} -->
                <div class="featured-slide {% if isFirstSlide %}active{% endif %}">
                    <!-- Photo Section -->
                    <div class="featured-photo">
                        <a href="{{ post.url | url }}" class="featured-photo-link" aria-label="Read {{ post.data.title }}">
                            {% if post.data.image %}
                            <picture>
                                {% if post.data.imageHigh %}
                                <source media="(min-width: 1920px)" srcset="{{ post.data.imageHigh }}">
                                {% endif %}
                                {% if post.data.imageDesktop %}
                                <source media="(min-width: 1280px)" srcset="{{ post.data.imageDesktop }}">
                                {% endif %}
                                {% if post.data.imageTablet %}
                                <source media="(min-width: 769px)" srcset="{{ post.data.imageTablet }}">
                                {% endif %}
                                {% if post.data.imageMobile %}
                                <source media="(max-width: 768px)" srcset="{{ post.data.imageMobile }}">
                                {% endif %}
                                <img 
                                    src="{{ post.data.image }}" 
                                    alt="{{ post.data.imageAlt or post.data.title }}"
                                    loading="{{ loadingStrategy }}"
                                    {% if isFirstSlide %}fetchpriority="high"{% endif %}
                                    class="featured-image"
                                    {% if post.data.imageFeaturedPosition %}style="object-position: {{ post.data.imageFeaturedPosition }};"{% endif %}>
                            </picture>
                            {% endif %}
                        </a>
                    </div>
                    
                    <!-- Content Section -->
                    <div class="featured-content">
                        {# Category badge #}
                        {% if post.data.category %}
                        <div class="featured-category">{{ post.data.category }}</div>
                        {% endif %}
                        
                        {# Title (link to full post) #}
                        <h3 class="featured-title">
                            <a href="{{ post.url | url }}">
                                {{ post.data.title }}
                            </a>
                        </h3>
                        
                        {# Description/Excerpt #}
                        <p class="featured-description">
                            {{ post.data.featuredExcerpt or post.data.description }}
                        </p>
                        
                        {# Metadata: Date and Read More #}
                        <div class="featured-meta">
                            <time datetime="{{ post.date | htmlDateString }}">
                                {{ post.date | readableDate }}
                            </time>
                            
                            <a href="{{ post.url | url }}" class="featured-read-more">
                                <span class="read-more-text">Read More</span>
                                <i data-lucide="arrow-right" class="read-more-icon"></i>
                            </a>
                        </div>
                        
                        {# Tags (optional) #}
                        {% if post.data.tags %}
                        <div class="featured-tags">
                            {% for tag in post.data.tags | limit(3) %}
                                <span class="featured-tag">{{ tag }}</span>
                            {% endfor %}
                        </div>
                        {% endif %}
                    </div>
                </div>
                {% endfor %}
            </div>

            <!-- Navigation Controls -->
            <div class="featured-posts-navigation">
                <button class="nav-btn" id="featured-posts-prev" aria-label="Previous featured post">
                    <i data-lucide="chevron-left"></i>
                </button>
                
                <div class="featured-posts-dots">
                    <!-- Dots will be generated by JavaScript -->
                </div>
                
                <button class="nav-btn" id="featured-posts-next" aria-label="Next featured post">
                    <i data-lucide="chevron-right"></i>
                </button>
            </div>
        </div>
    </div>
</section>
{% endif %}
